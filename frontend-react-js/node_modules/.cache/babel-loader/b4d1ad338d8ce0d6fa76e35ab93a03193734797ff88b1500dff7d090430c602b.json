{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/aws-bootcamp-cruddur-2023/frontend-react-js/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"/workspace/aws-bootcamp-cruddur-2023/frontend-react-js/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/workspace/aws-bootcamp-cruddur-2023/frontend-react-js/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspace/aws-bootcamp-cruddur-2023/frontend-react-js/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./ActivityForm.css';import React from\"react\";import process from'process';import{ReactComponent as BombIcon}from'./svg/bomb.svg';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ActivityForm(props){var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),count=_React$useState2[0],setCount=_React$useState2[1];var _React$useState3=React.useState(''),_React$useState4=_slicedToArray(_React$useState3,2),message=_React$useState4[0],setMessage=_React$useState4[1];var _React$useState5=React.useState('7-days'),_React$useState6=_slicedToArray(_React$useState5,2),ttl=_React$useState6[0],setTtl=_React$useState6[1];var classes=[];classes.push('count');if(240-count<0){classes.push('err');}var onsubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var backend_url,res,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;backend_url=\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/api/activities\");console.log('onsubmit payload',message);_context.next=6;return fetch(backend_url,{method:\"POST\",headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({message:message,ttl:ttl})});case 6:res=_context.sent;_context.next=9;return res.json();case 9:data=_context.sent;if(res.status===200){// add activity to the feed\nprops.setActivities(function(current){return[data].concat(_toConsumableArray(current));});// reset and close the form\nsetCount(0);setMessage('');setTtl('7-days');props.setPopped(false);}else{console.log(res);}_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 16:case\"end\":return _context.stop();}}},_callee,null,[[1,13]]);}));return function onsubmit(_x){return _ref.apply(this,arguments);};}();var textarea_onchange=function textarea_onchange(event){setCount(event.target.value.length);setMessage(event.target.value);};var ttl_onchange=function ttl_onchange(event){setTtl(event.target.value);};if(props.popped===true){return/*#__PURE__*/_jsxs(\"form\",{className:\"activity_form\",onSubmit:onsubmit,children:[/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",placeholder:\"what would you like to say?\",value:message,onChange:textarea_onchange}),/*#__PURE__*/_jsxs(\"div\",{className:\"submit\",children:[/*#__PURE__*/_jsx(\"div\",{className:classes.join(' '),children:240-count}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Crud\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"expires_at_field\",children:[/*#__PURE__*/_jsx(BombIcon,{className:\"icon\"}),/*#__PURE__*/_jsxs(\"select\",{value:ttl,onChange:ttl_onchange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"30-days\",children:\"30 days\"}),/*#__PURE__*/_jsx(\"option\",{value:\"7-days\",children:\"7 days\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3-days\",children:\"3 days\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1-day\",children:\"1 day\"}),/*#__PURE__*/_jsx(\"option\",{value:\"12-hours\",children:\"12 hours\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3-hours\",children:\"3 hours\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1-hour\",children:\"1 hour \"})]})]})]})]});}}","map":{"version":3,"names":["React","process","ReactComponent","BombIcon","ActivityForm","props","useState","count","setCount","message","setMessage","ttl","setTtl","classes","push","onsubmit","event","preventDefault","backend_url","env","REACT_APP_BACKEND_URL","console","log","fetch","method","headers","body","JSON","stringify","res","json","data","status","setActivities","current","setPopped","textarea_onchange","target","value","length","ttl_onchange","popped","join"],"sources":["/workspace/aws-bootcamp-cruddur-2023/frontend-react-js/src/components/ActivityForm.js"],"sourcesContent":["import './ActivityForm.css';\r\nimport React from \"react\";\r\nimport process from 'process';\r\nimport {ReactComponent as BombIcon} from './svg/bomb.svg';\r\n\r\nexport default function ActivityForm(props) {\r\n  const [count, setCount] = React.useState(0);\r\n  const [message, setMessage] = React.useState('');\r\n  const [ttl, setTtl] = React.useState('7-days');\r\n\r\n  const classes = []\r\n  classes.push('count')\r\n  if (240-count < 0){\r\n    classes.push('err')\r\n  }\r\n\r\n  const onsubmit = async (event) => {\r\n    event.preventDefault();\r\n    try {\r\n      const backend_url = `${process.env.REACT_APP_BACKEND_URL}/api/activities`\r\n      console.log('onsubmit payload', message)\r\n      const res = await fetch(backend_url, {\r\n        method: \"POST\",\r\n        headers: {\r\n          'Accept': 'application/json',\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n          message: message,\r\n          ttl: ttl\r\n        }),\r\n      });\r\n      let data = await res.json();\r\n      if (res.status === 200) {\r\n        // add activity to the feed\r\n        props.setActivities(current => [data,...current]);\r\n        // reset and close the form\r\n        setCount(0)\r\n        setMessage('')\r\n        setTtl('7-days')\r\n        props.setPopped(false)\r\n      } else {\r\n        console.log(res)\r\n      }\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n  const textarea_onchange = (event) => {\r\n    setCount(event.target.value.length);\r\n    setMessage(event.target.value);\r\n  }\r\n\r\n  const ttl_onchange = (event) => {\r\n    setTtl(event.target.value);\r\n  }\r\n\r\n  if (props.popped === true) {\r\n    return (\r\n      <form \r\n        className='activity_form'\r\n        onSubmit={onsubmit}\r\n      >\r\n        <textarea\r\n          type=\"text\"\r\n          placeholder=\"what would you like to say?\"\r\n          value={message}\r\n          onChange={textarea_onchange} \r\n        />\r\n        <div className='submit'>\r\n          <div className={classes.join(' ')}>{240-count}</div>\r\n          <button type='submit'>Crud</button>\r\n          <div className='expires_at_field'>\r\n            <BombIcon className='icon' />\r\n            <select\r\n              value={ttl}\r\n              onChange={ttl_onchange} \r\n            >\r\n              <option value='30-days'>30 days</option>\r\n              <option value='7-days'>7 days</option>\r\n              <option value='3-days'>3 days</option>\r\n              <option value='1-day'>1 day</option>\r\n              <option value='12-hours'>12 hours</option>\r\n              <option value='3-hours'>3 hours</option>\r\n              <option value='1-hour'>1 hour </option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    );\r\n  }\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}