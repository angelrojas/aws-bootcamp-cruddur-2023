{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/aws-bootcamp-cruddur-2023/frontend-react-js/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/workspace/aws-bootcamp-cruddur-2023/frontend-react-js/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspace/aws-bootcamp-cruddur-2023/frontend-react-js/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./NotificationsFeedPage.css';import React from\"react\";import DesktopNavigation from'../components/DesktopNavigation';import DesktopSidebar from'../components/DesktopSidebar';import ActivityFeed from'../components/ActivityFeed';import ActivityForm from'../components/ActivityForm';import ReplyForm from'../components/ReplyForm';// [TODO] Authenication\nimport Cookies from'js-cookie';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function NotificationsFeedPage(){var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),activities=_React$useState2[0],setActivities=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),popped=_React$useState4[0],setPopped=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),poppedReply=_React$useState6[0],setPoppedReply=_React$useState6[1];var _React$useState7=React.useState({}),_React$useState8=_slicedToArray(_React$useState7,2),replyActivity=_React$useState8[0],setReplyActivity=_React$useState8[1];var _React$useState9=React.useState(null),_React$useState10=_slicedToArray(_React$useState9,2),user=_React$useState10[0],setUser=_React$useState10[1];var dataFetchedRef=React.useRef(false);var loadData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var backend_url,res,resJson;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;backend_url=\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/api/activities/notifications\");_context.next=4;return fetch(backend_url,{method:\"GET\"});case 4:res=_context.sent;_context.next=7;return res.json();case 7:resJson=_context.sent;if(res.status===200){setActivities(resJson);}else{console.log(res);}_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function loadData(){return _ref.apply(this,arguments);};}();var checkAuth=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log('checkAuth');// [TODO] Authenication\nif(Cookies.get('user.logged_in')){setUser({display_name:Cookies.get('user.name'),handle:Cookies.get('user.username')});}case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function checkAuth(){return _ref2.apply(this,arguments);};}();React.useEffect(function(){//prevents double call\nif(dataFetchedRef.current)return;dataFetchedRef.current=true;loadData();checkAuth();},[]);return/*#__PURE__*/_jsxs(\"article\",{children:[/*#__PURE__*/_jsx(DesktopNavigation,{user:user,active:'notifications',setPopped:setPopped}),/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsx(ActivityForm,{popped:popped,setPopped:setPopped,setActivities:setActivities}),/*#__PURE__*/_jsx(ReplyForm,{activity:replyActivity,popped:poppedReply,setPopped:setPoppedReply,setActivities:setActivities,activities:activities}),/*#__PURE__*/_jsx(ActivityFeed,{title:\"Notifications\",setReplyActivity:setReplyActivity,setPopped:setPoppedReply,activities:activities})]}),/*#__PURE__*/_jsx(DesktopSidebar,{user:user})]});}","map":{"version":3,"names":["React","DesktopNavigation","DesktopSidebar","ActivityFeed","ActivityForm","ReplyForm","Cookies","NotificationsFeedPage","useState","activities","setActivities","popped","setPopped","poppedReply","setPoppedReply","replyActivity","setReplyActivity","user","setUser","dataFetchedRef","useRef","loadData","backend_url","process","env","REACT_APP_BACKEND_URL","fetch","method","res","json","resJson","status","console","log","checkAuth","get","display_name","handle","useEffect","current"],"sources":["/workspace/aws-bootcamp-cruddur-2023/frontend-react-js/src/pages/NotificationsFeedPage.js"],"sourcesContent":["import './NotificationsFeedPage.css';\nimport React from \"react\";\n\nimport DesktopNavigation  from '../components/DesktopNavigation';\nimport DesktopSidebar     from '../components/DesktopSidebar';\nimport ActivityFeed from '../components/ActivityFeed';\nimport ActivityForm from '../components/ActivityForm';\nimport ReplyForm from '../components/ReplyForm';\n\n// [TODO] Authenication\nimport Cookies from 'js-cookie'\n\nexport default function NotificationsFeedPage() {\n  const [activities, setActivities] = React.useState([]);\n  const [popped, setPopped] = React.useState(false);\n  const [poppedReply, setPoppedReply] = React.useState(false);\n  const [replyActivity, setReplyActivity] = React.useState({});\n  const [user, setUser] = React.useState(null);\n  const dataFetchedRef = React.useRef(false);\n\n  const loadData = async () => {\n    try {\n      const backend_url = `${process.env.REACT_APP_BACKEND_URL}/api/activities/notifications`\n      const res = await fetch(backend_url, {\n        method: \"GET\"\n      });\n      let resJson = await res.json();\n      if (res.status === 200) {\n        setActivities(resJson)\n      } else {\n        console.log(res)\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const checkAuth = async () => {\n    console.log('checkAuth')\n    // [TODO] Authenication\n    if (Cookies.get('user.logged_in')) {\n      setUser({\n        display_name: Cookies.get('user.name'),\n        handle: Cookies.get('user.username')\n      })\n    }\n  };\n\n  React.useEffect(()=>{\n    //prevents double call\n    if (dataFetchedRef.current) return;\n    dataFetchedRef.current = true;\n\n    loadData();\n    checkAuth();\n  }, [])\n\n  return (\n    <article>\n      <DesktopNavigation user={user} active={'notifications'} setPopped={setPopped} />\n      <div className='content'>\n        <ActivityForm  \n          popped={popped}\n          setPopped={setPopped} \n          setActivities={setActivities} \n        />\n        <ReplyForm \n          activity={replyActivity} \n          popped={poppedReply} \n          setPopped={setPoppedReply} \n          setActivities={setActivities} \n          activities={activities} \n        />\n        <ActivityFeed \n          title=\"Notifications\" \n          setReplyActivity={setReplyActivity} \n          setPopped={setPoppedReply} \n          activities={activities} \n        />\n      </div>\n      <DesktopSidebar user={user} />\n    </article>\n  );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}