{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/aws-bootcamp-cruddur-2023/frontend-react-js/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/workspace/aws-bootcamp-cruddur-2023/frontend-react-js/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspace/aws-bootcamp-cruddur-2023/frontend-react-js/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'./ReplyForm.css';import React from\"react\";import process from'process';import{ReactComponent as BombIcon}from'./svg/bomb.svg';import ActivityContent from'../components/ActivityContent';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ReplyForm(props){var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),count=_React$useState2[0],setCount=_React$useState2[1];var _React$useState3=React.useState(''),_React$useState4=_slicedToArray(_React$useState3,2),message=_React$useState4[0],setMessage=_React$useState4[1];var classes=[];classes.push('count');if(240-count<0){classes.push('err');}var onsubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var backend_url,res,data,activities_deep_copy,found_activity;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;backend_url=\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/api/activities/\").concat(props.activity.uuid,\"/reply\");_context.next=5;return fetch(backend_url,{method:\"POST\",headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify({message:message})});case 5:res=_context.sent;_context.next=8;return res.json();case 8:data=_context.sent;if(res.status===200){// add activity to the feed\nactivities_deep_copy=JSON.parse(JSON.stringify(props.activities));found_activity=activities_deep_copy.find(function(element){return element.uuid===props.activity.uuid;});found_activity.replies.push(data);props.setActivities(activities_deep_copy);// reset and close the form\nsetCount(0);setMessage('');props.setPopped(false);}else{console.log(res);}_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 15:case\"end\":return _context.stop();}}},_callee,null,[[1,12]]);}));return function onsubmit(_x){return _ref.apply(this,arguments);};}();var textarea_onchange=function textarea_onchange(event){setCount(event.target.value.length);setMessage(event.target.value);};var content;if(props.activity){content=/*#__PURE__*/_jsx(ActivityContent,{activity:props.activity});}if(props.popped===true){return/*#__PURE__*/_jsx(\"div\",{className:\"popup_form_wrap\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"popup_form\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"popup_heading\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"popup_content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"activity_wrap\",children:content}),/*#__PURE__*/_jsxs(\"form\",{className:\"replies_form\",onSubmit:onsubmit,children:[/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",placeholder:\"what is your reply?\",value:message,onChange:textarea_onchange}),/*#__PURE__*/_jsxs(\"div\",{className:\"submit\",children:[/*#__PURE__*/_jsx(\"div\",{className:classes.join(' '),children:240-count}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Reply\"})]})]})]})]})});}}","map":{"version":3,"names":["React","process","ReactComponent","BombIcon","ActivityContent","ReplyForm","props","useState","count","setCount","message","setMessage","classes","push","onsubmit","event","preventDefault","backend_url","env","REACT_APP_BACKEND_URL","activity","uuid","fetch","method","headers","body","JSON","stringify","res","json","data","status","activities_deep_copy","parse","activities","found_activity","find","element","replies","setActivities","setPopped","console","log","textarea_onchange","target","value","length","content","popped","join"],"sources":["/workspace/aws-bootcamp-cruddur-2023/frontend-react-js/src/components/ReplyForm.js"],"sourcesContent":["import './ReplyForm.css';\nimport React from \"react\";\nimport process from 'process';\nimport {ReactComponent as BombIcon} from './svg/bomb.svg';\n\nimport ActivityContent  from '../components/ActivityContent';\n\nexport default function ReplyForm(props) {\n  const [count, setCount] = React.useState(0);\n  const [message, setMessage] = React.useState('');\n\n  const classes = []\n  classes.push('count')\n  if (240-count < 0){\n    classes.push('err')\n  }\n\n  const onsubmit = async (event) => {\n    event.preventDefault();\n    try {\n      const backend_url = `${process.env.REACT_APP_BACKEND_URL}/api/activities/${props.activity.uuid}/reply`\n      const res = await fetch(backend_url, {\n        method: \"POST\",\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          message: message\n        }),\n      });\n      let data = await res.json();\n      if (res.status === 200) {\n        // add activity to the feed\n\n        let activities_deep_copy = JSON.parse(JSON.stringify(props.activities))\n        let found_activity = activities_deep_copy.find(function (element) {\n          return element.uuid ===  props.activity.uuid;\n        });\n        found_activity.replies.push(data)\n\n        props.setActivities(activities_deep_copy);\n        // reset and close the form\n        setCount(0)\n        setMessage('')\n        props.setPopped(false)\n      } else {\n        console.log(res)\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  const textarea_onchange = (event) => {\n    setCount(event.target.value.length);\n    setMessage(event.target.value);\n  }\n\n  let content;\n  if (props.activity){\n    content = <ActivityContent activity={props.activity} />;\n  }\n\n\n  if (props.popped === true) {\n    return (\n      <div className=\"popup_form_wrap\">\n        <div className=\"popup_form\">\n          <div className=\"popup_heading\">\n          </div>\n          <div className=\"popup_content\">\n            <div className=\"activity_wrap\">\n              {content}\n            </div>\n            <form \n              className='replies_form'\n              onSubmit={onsubmit}\n            >\n              <textarea\n                type=\"text\"\n                placeholder=\"what is your reply?\"\n                value={message}\n                onChange={textarea_onchange} \n              />\n              <div className='submit'>\n                <div className={classes.join(' ')}>{240-count}</div>\n                <button type='submit'>Reply</button>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}